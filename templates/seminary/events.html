{% extends 'base.html' %}
{% load static %}
{% load content_filters %}

{% block title %}Events - Holy Spirit Major Seminary{% endblock %}

{% block content %}
<!-- Page Header -->
<section class="bg-gradient-primary text-white py-20">
    <div class="container mx-auto px-4">
        <div class="max-w-4xl mx-auto text-center">
            <h1 class="text-5xl font-bold font-serif mb-4 animate-fade-in-up">Seminary Events</h1>
            <p class="text-xl opacity-90 animate-fade-in-up" style="animation-delay: 0.2s;">
                Join us for spiritual, academic, and community events
            </p>
            <nav class="text-lg opacity-80 mt-4 animate-fade-in-up" style="animation-delay: 0.3s;">
                <a href="{% url 'home' %}" class="hover:text-blue-200 transition-colors">Home</a>
                <span class="mx-3">/</span>
                <span>Events</span>
            </nav>
        </div>
    </div>
</section>

<!-- Featured Events -->
{% if featured_events %}
<section class="py-16 bg-white">
    <div class="container mx-auto px-4">
        <div class="text-center mb-12">
            <h2 class="text-3xl font-bold font-serif text-gray-800 mb-4">Featured Events</h2>
            <p class="text-gray-600 text-lg">Don't miss these important upcoming events</p>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            {% for event in featured_events %}
            <div class="bg-white border-2 border-blue-200 rounded-lg overflow-hidden shadow-lg hover-lift">
                <div class="relative">
                    {% if event.featured_image %}
                    <img src="{{ event.featured_image.url }}" 
                         alt="{{ event.title }}" 
                         class="w-full h-48 object-cover">
                    {% else %}
                    <div class="w-full h-48 bg-gradient-primary flex items-center justify-center text-white text-4xl">
                        <i class="fas fa-calendar-alt"></i>
                    </div>
                    {% endif %}
                    <div class="absolute top-4 right-4 bg-white text-blue-600 px-3 py-1 rounded-full text-sm font-semibold">
                        Featured
                    </div>
                </div>
                <div class="p-6">
                    <div class="flex items-start space-x-4 mb-4">
                        <div class="bg-gradient-primary text-white rounded-lg p-3 text-center min-w-[80px]">
                            <div class="text-2xl font-bold">{{ event.start_date.day }}</div>
                            <div class="text-sm">{{ event.start_date|date:"M" }}</div>
                        </div>
                        <div class="flex-1">
                            <h3 class="text-xl font-semibold mb-2">{{ event.title }}</h3>
                            <div class="space-y-1 text-sm text-gray-600">
                                <div class="flex items-center">
                                    <i class="fas fa-clock mr-2 w-4"></i>
                                    {{ event.start_date|date:"M d, Y" }} at {{ event.start_date|time:"H:i" }}
                                </div>
                                {% if event.location %}
                                <div class="flex items-center">
                                    <i class="fas fa-map-marker-alt mr-2 w-4"></i>
                                    {{ event.location }}
                                </div>
                                {% endif %}
                                {% if event.event_type %}
                                <div class="flex items-center">
                                    <i class="fas fa-tag mr-2 w-4"></i>
                                    {{ event.get_event_type_display }}
                                </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    <p class="text-gray-600 mb-4">{{ event.description|preview_content:20 }}</p>
                    <div class="flex items-center justify-between">
                        <a href="{{ event.get_absolute_url }}" 
                           class="text-blue-600 font-medium hover:text-blue-800 transition-colors">
                            View Details <i class="fas fa-arrow-right ml-1"></i>
                        </a>
                        {% if event.registration_required %}
                        <span class="bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full">
                            Registration Required
                        </span>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>
{% endif %}

<!-- Event Categories Filter -->
<section class="py-8 bg-gray-50 border-y border-gray-200">
    <div class="container mx-auto px-4">
        <div class="flex flex-wrap justify-center gap-4">
            <button class="filter-btn active px-6 py-3 rounded-full font-medium transition-all duration-300 bg-gradient-primary text-white" 
                    data-filter="all">
                All Events
            </button>
            <button class="filter-btn px-6 py-3 rounded-full font-medium transition-all duration-300 bg-white text-gray-700 hover:bg-gray-100" 
                    data-filter="upcoming">
                Upcoming
            </button>
            <button class="filter-btn px-6 py-3 rounded-full font-medium transition-all duration-300 bg-white text-gray-700 hover:bg-gray-100" 
                    data-filter="conference">
                Conferences
            </button>
            <button class="filter-btn px-6 py-3 rounded-full font-medium transition-all duration-300 bg-white text-gray-700 hover:bg-gray-100" 
                    data-filter="seminar">
                Seminars
            </button>
            <button class="filter-btn px-6 py-3 rounded-full font-medium transition-all duration-300 bg-white text-gray-700 hover:bg-gray-100" 
                    data-filter="retreat">
                Retreats
            </button>
            <button class="filter-btn px-6 py-3 rounded-full font-medium transition-all duration-300 bg-white text-gray-700 hover:bg-gray-100" 
                    data-filter="celebration">
                Celebrations
            </button>
        </div>
    </div>
</section>

<!-- Upcoming Events -->
{% if upcoming_events %}
<section class="py-16 bg-white">
    <div class="container mx-auto px-4">
        <div class="text-center mb-12">
            <h2 class="text-3xl font-bold font-serif text-gray-800 mb-4">Upcoming Events</h2>
            <p class="text-gray-600">Mark your calendar for these upcoming events</p>
        </div>
        <div class="space-y-6" id="upcoming-events">
            {% for event in upcoming_events %}
            <div class="event-item bg-white border border-gray-200 rounded-lg p-6 shadow hover:shadow-lg transition-shadow" 
                 data-type="{{ event.event_type }}" 
                 data-status="upcoming">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 items-center">
                    <div class="md:col-span-1">
                        <div class="bg-gradient-primary text-white rounded-lg p-4 text-center">
                            <div class="text-3xl font-bold">{{ event.start_date.day }}</div>
                            <div class="text-sm">{{ event.start_date|date:"M Y" }}</div>
                            <div class="text-xs mt-1">{{ event.start_date|time:"H:i" }}</div>
                        </div>
                    </div>
                    <div class="md:col-span-2">
                        <h3 class="text-xl font-semibold mb-2">{{ event.title }}</h3>
                        <p class="text-gray-600 mb-3">{{ event.description|smart_preview:25 }}</p>
                        <div class="flex flex-wrap gap-4 text-sm text-gray-500">
                            {% if event.location %}
                            <span>
                                <i class="fas fa-map-marker-alt mr-1"></i>
                                {{ event.location }}
                            </span>
                            {% endif %}
                            {% if event.organizer %}
                            <span>
                                <i class="fas fa-user mr-1"></i>
                                {{ event.organizer }}
                            </span>
                            {% endif %}
                            {% if event.event_type %}
                            <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-full">
                                {{ event.get_event_type_display }}
                            </span>
                            {% endif %}
                        </div>
                    </div>
                    <div class="md:col-span-1 text-center md:text-right">
                        <div class="space-y-3">
                            <a href="{{ event.get_absolute_url }}" 
                               class="block px-6 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors">
                                View Details
                            </a>
                            {% if event.registration_required %}
                            <a href="{% url 'event_register' event.slug %}" 
                               class="block px-6 py-2 border border-green-600 text-green-600 rounded-lg font-medium hover:bg-green-600 hover:text-white transition-colors">
                                Register Now
                            </a>
                            {% endif %}
                        </div>
                        {% if event.registration_required and event.max_participants %}
                        <div class="mt-3 text-sm text-gray-500">
                            Max: {{ event.max_participants }} participants
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>
{% endif %}

<!-- Past Events -->
{% if past_events %}
<section class="py-16 bg-gray-50">
    <div class="container mx-auto px-4">
        <div class="text-center mb-12">
            <h2 class="text-3xl font-bold font-serif text-gray-800 mb-4">Past Events</h2>
            <p class="text-gray-600">Browse our recent events and activities</p>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" id="past-events">
            {% for event in past_events %}
            <div class="event-item bg-white rounded-lg shadow hover:shadow-lg transition-shadow overflow-hidden" 
                 data-type="{{ event.event_type }}" 
                 data-status="past">
                {% if event.featured_image %}
                <img src="{{ event.featured_image.url }}" 
                     alt="{{ event.title }}" 
                     class="w-full h-48 object-cover">
                {% else %}
                <div class="w-full h-48 bg-gray-300 flex items-center justify-center text-gray-500 text-3xl">
                    <i class="fas fa-calendar-check"></i>
                </div>
                {% endif %}
                <div class="p-6">
                    <div class="text-sm text-gray-500 mb-2">{{ event.start_date|date:"M d, Y" }}</div>
                    <h3 class="text-lg font-semibold mb-3">{{ event.title }}</h3>
                    <p class="text-gray-600 text-sm mb-4">{{ event.description|smart_preview:15 }}</p>
                    <div class="flex items-center justify-between">
                        <span class="bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded-full">
                            {{ event.get_event_type_display }}
                        </span>
                        <a href="{{ event.get_absolute_url }}" 
                           class="text-blue-600 font-medium hover:text-blue-800 transition-colors text-sm">
                            View Details <i class="fas fa-arrow-right ml-1"></i>
                        </a>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        <div class="text-center mt-12">
            <button id="load-more-past" 
                    class="px-8 py-3 border border-gray-400 text-gray-700 rounded-lg font-medium hover:bg-gray-100 transition-colors"
                    hx-get="{% url 'load_more_events' %}"
                    hx-target="#past-events"
                    hx-swap="beforeend">
                Load More Past Events
            </button>
        </div>
    </div>
</section>
{% endif %}

<!-- Call to Action -->

{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Event filtering
    const filterButtons = document.querySelectorAll('.filter-btn');
    const eventItems = document.querySelectorAll('.event-item');
    
    filterButtons.forEach(button => {
        button.addEventListener('click', function() {
            // Update active button
            filterButtons.forEach(btn => {
                btn.classList.remove('active', 'bg-gradient-primary', 'text-white');
                btn.classList.add('bg-white', 'text-gray-700');
            });
            
            this.classList.add('active', 'bg-gradient-primary', 'text-white');
            this.classList.remove('bg-white', 'text-gray-700');
            
            // Filter events
            const filterValue = this.getAttribute('data-filter');
            
            eventItems.forEach(item => {
                if (filterValue === 'all') {
                    item.style.display = 'block';
                } else if (filterValue === 'upcoming') {
                    item.style.display = item.getAttribute('data-status') === 'upcoming' ? 'block' : 'none';
                } else {
                    item.style.display = item.getAttribute('data-type') === filterValue ? 'block' : 'none';
                }
            });
        });
    });
});
</script>
{% endblock %}